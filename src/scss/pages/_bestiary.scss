@use '../common/vars' as *;
@use '../common/vars' as mixins;

@use 'bestiary/actions';
@use 'bestiary/affinity';
// @use 'bestiary/attributes';
@use 'bestiary/bio';
// @use 'bestiary/defenses';
@use 'bestiary/equipment';
@use 'bestiary/extras';
@use 'bestiary/other';
// @use 'bestiary/points';
// @use 'shared/statistics';

.fabula-ultima {
  .bestiary {
    $this: '.bestiary';

    &--view {
      min-width: $breakpoint-xs;
      margin: 8px;
      max-width: 500px;
      background-color: var(--suface-container-lowest);

      box-shadow: var(--box-shadow-light);
      border-radius: 4px;

      display: flex;
      flex-direction: column;
      gap: 4px;

      * ~ .repcontrol {
        display: none;
      }

      .statistics {
        .affinities {
          grid-column: span 3;

          display: grid;
          grid-template-columns: repeat(9, minmax(3rem, auto));
          gap: 2px;

          text-align: center;

          border: 1px solid var(--color-fabula0);
          border-right: none;
          border-image: var(--fabula-gradient-primary-border);

          label,
          span {
            @include mixins.text-lg-700-fabula;
            text-align: center;
            white-space: nowrap;
            color: var(--color-hp);
            text-transform: uppercase;
          }
        }

        .affinity--cell {
          display: grid;
          grid-template-columns: 1.5rem auto;
          align-items: center;

          padding: 2px;

          @each $attr in 1, 2, 3, 4, 5, 6, 7, 8 {
            &:nth-of-type(#{$attr}) {
              border-right: 1px
                solid
                color-mix(in srgb, white #{$attr * 12%}, var(--color-fabula5));
            }
          }

          label {
            @include mixins.sr-only;
          }

          input:not([value]),
          input[value=''] {
            + img {
              opacity: 0.25;
              filter: grayscale(1);
            }
          }
        }
      }

      .status-effects {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 4px;
      }

      .status-effect {
        img,
        svg {
          // margin: 0; bolt svg is weird
          filter: none;
        }
      }
    }

    &--edit {
      min-width: $breakpoint-xxs;
      display: grid;
      gap: 8px;
      margin: 8px;

      padding: 8px;
      background-color: var(--bestiary-edit-background);

      > div {
        height: min-content;
      }

      @media (min-width: $breakpoint-sm) {
        grid-template-columns: repeat(4, 1fr);

        .bio--edit {
          grid-column: 1 / span 3;
        }
        .attributes {
          grid-column-start: 1;
          &__distribution {
            grid-column: span 3;
          }
        }
        .affinities {
          grid-row: 3 / span 2;
          &__skillcost {
            grid-column: span 3;
          }
        }

        .defenses--edit {
          grid-column: 2;
          align-self: flex-end;
        }
        .extras {
          grid-column: 3;
          align-self: flex-end;
        }
        .extra--checkboxes {
          grid-column: 4;
          align-self: flex-end;
        }

        .shield--edit,
        .weapons {
          grid-column: 3 / span 2;
        }

        .armor--edit,
        .basic-attacks {
          grid-column: 1 / span 2;
        }

        .spells {
          grid-column: 1/-1;
        }

        .other-actions,
        .special-rules,
        .rare-gears,
        .notes {
          grid-column: span 2;
        }
      }

      @media (max-width: $breakpoint-sm) {
        grid-template-columns: repeat(3, 1fr);

        .bio--edit {
          grid-column: 1/-1;
        }
        .attributes {
          &__distribution {
            grid-column: span 2;
          }
        }
        .affinities {
          &__skillcost {
            grid-column: span 2;
          }
        }

        .defenses--edit,
        .extras,
        .extra--checkboxes {
          align-self: flex-end;
        }

        .shield--edit,
        .weapons,
        .armor--edit,
        .basic-attacks,
        .spells,
        .other-actions,
        .special-rules,
        .rare-gears,
        .notes {
          grid-column: 1/-1;
        }
      }

      @media (max-width: $breakpoint-xs) {
        .defenses--edit,
        .extras,
        .extra--checkboxes {
          grid-column: 1/-1;
        }
      }
    }
  }
}
